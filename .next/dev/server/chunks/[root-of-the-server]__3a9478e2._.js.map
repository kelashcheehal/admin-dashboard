{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/work/wbadmindashboard/proxy.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\n\r\nexport function middleware(req: NextRequest) {\r\n  const { pathname } = req.nextUrl;\r\n\r\n  if (pathname.startsWith(\"/admin\")) {\r\n    const token = req.cookies.get(\"__session\")?.value;\r\n\r\n    if (!token) {\r\n      return NextResponse.redirect(new URL(\"/unauthorized\", req.url));\r\n    }\r\n\r\n    try {\r\n      const payload = JSON.parse(\r\n        Buffer.from(token.split(\".\")[1], \"base64\").toString()\r\n      );\r\n\r\n      if (payload?.public_metadata?.role !== \"admin\") {\r\n        return NextResponse.redirect(new URL(\"/unauthorized\", req.url));\r\n      }\r\n    } catch (e) {\r\n      return NextResponse.redirect(new URL(\"/unauthorized\", req.url));\r\n    }\r\n  }\r\n\r\n  return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/admin/:path*\"], // Protect all /admin subpaths\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAGO,SAAS,WAAW,GAAgB;IACzC,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,IAAI,SAAS,UAAU,CAAC,WAAW;QACjC,MAAM,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,cAAc;QAE5C,IAAI,CAAC,OAAO;YACV,OAAO,6QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;QAC/D;QAEA,IAAI;YACF,MAAM,UAAU,KAAK,KAAK,CACxB,OAAO,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE,UAAU,QAAQ;YAGrD,IAAI,SAAS,iBAAiB,SAAS,SAAS;gBAC9C,OAAO,6QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;YAC/D;QACF,EAAE,OAAO,GAAG;YACV,OAAO,6QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;QAC/D;IACF;IAEA,OAAO,6QAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAgB;AAC5B"}}]
}